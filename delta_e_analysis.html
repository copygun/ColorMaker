<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delta E 2000 ì°¨ì´ ë¶„ì„</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            padding: 20px;
            background: #f5f5f5;
            line-height: 1.6;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #2196F3;
            padding-bottom: 10px;
        }
        .analysis-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .box {
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }
        .highlight {
            background: #fffde7;
            padding: 2px 5px;
            border-radius: 3px;
        }
        .suspect {
            background: #ffebee;
            border-left: 4px solid #f44336;
            padding: 10px;
            margin: 10px 0;
        }
        .correct {
            background: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 10px;
            margin: 10px 0;
        }
        .warning {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 10px;
            margin: 10px 0;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background: #f0f0f0;
        }
        .formula {
            background: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            margin: 10px 0;
        }
        button {
            background: #2196F3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 0;
        }
        button:hover {
            background: #1976D2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Delta E 2000 ê³„ì‚° ì°¨ì´ ì‹¬ì¸µ ë¶„ì„</h1>
        
        <div class="warning">
            <h3>âš ï¸ ë¬¸ì œ ìƒí™©</h3>
            <p><strong>ì…ë ¥ê°’:</strong> ëª©í‘œ L*=43.7, a*=-31.9, b*=2.8 | ì‹œë£Œ L*=43.9, a*=-27.3, b*=1.8</p>
            <p><strong>ìš°ë¦¬ ê³„ì‚°:</strong> Î”E00 = 2.10</p>
            <p><strong>ì¸¡ì •ê¸° ì•± (dE*00):</strong> Î”E00 = 2.80</p>
            <p><strong>ì°¨ì´:</strong> 0.70 (33% ì°¨ì´)</p>
        </div>

        <h2>ğŸ“Š ê°€ëŠ¥í•œ ì›ì¸ ë¶„ì„</h2>
        
        <div class="analysis-grid">
            <div class="box suspect">
                <h3>1. ê°€ì¤‘ì¹˜ íŒŒë¼ë¯¸í„° (kL, kC, kH)</h3>
                <p>Delta E 2000ì€ ìš©ë„ì— ë”°ë¼ ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:</p>
                <ul>
                    <li><strong>í‘œì¤€ (1:1:1):</strong> ìš°ë¦¬ê°€ ì‚¬ìš© ì¤‘</li>
                    <li><strong>í…ìŠ¤íƒ€ì¼ (2:1:1):</strong> ëª…ë„ ì°¨ì´ ê°•ì¡°</li>
                    <li><strong>ê·¸ë˜í”½ ì•„íŠ¸ (1:1:1):</strong> í‘œì¤€ê³¼ ë™ì¼</li>
                </ul>
                <button onclick="testWeightings()">ê°€ì¤‘ì¹˜ í…ŒìŠ¤íŠ¸</button>
            </div>
            
            <div class="box suspect">
                <h3>2. ê´€ì°° ì¡°ê±´ íŒŒë¼ë¯¸í„°</h3>
                <p>Delta E 2000 ê³„ì‚° ì‹œ ë‹¤ë¥¸ íŒŒë¼ë¯¸í„° ê°€ëŠ¥ì„±:</p>
                <ul>
                    <li><strong>Illuminant:</strong> D50 vs D65</li>
                    <li><strong>Observer:</strong> 2Â° vs 10Â°</li>
                    <li><strong>Surround:</strong> Average vs Dim vs Dark</li>
                </ul>
            </div>
            
            <div class="box warning">
                <h3>3. ê³„ì‚° êµ¬í˜„ ì°¨ì´</h3>
                <p>íŠ¹ì • ë‹¨ê³„ì—ì„œ ë‹¤ë¥¸ ì²˜ë¦¬:</p>
                <ul>
                    <li>Hue ê°ë„ ì²˜ë¦¬ (0-360Â° ë²”ìœ„)</li>
                    <li>Î”h' ê³„ì‚° ì‹œ Â±180Â° ì²˜ë¦¬</li>
                    <li>RT (rotation term) ê³„ì‚°</li>
                </ul>
            </div>
            
            <div class="box warning">
                <h3>4. ë°˜ì˜¬ë¦¼/ì •ë°€ë„</h3>
                <p>ì¤‘ê°„ ê³„ì‚°ê°’ ë°˜ì˜¬ë¦¼ ì°¨ì´:</p>
                <ul>
                    <li>ì†Œìˆ˜ì  ì²˜ë¦¬ ì •ë°€ë„</li>
                    <li>ì‚¼ê°í•¨ìˆ˜ ê³„ì‚° ì •ë°€ë„</li>
                    <li>ì œê³±ê·¼ ê³„ì‚° ë°©ì‹</li>
                </ul>
            </div>
        </div>

        <h2>ğŸ§ª ì—­ê³„ì‚° ë¶„ì„</h2>
        <div class="formula">
            ì¸¡ì •ê¸° Î”E00 = 2.80ì´ ë‚˜ì˜¤ë ¤ë©´?<br>
            í•„ìš”í•œ ì¡°ì •: ì•½ 33% ì¦ê°€<br>
            <br>
            ê°€ëŠ¥í•œ ì‹œë‚˜ë¦¬ì˜¤:<br>
            1. kL = 0.75 (ëª…ë„ ê°€ì¤‘ì¹˜ ê°ì†Œ) â†’ Î”E â‰ˆ 2.65<br>
            2. kL = 0.65 â†’ Î”E â‰ˆ 2.82 âœ“<br>
            3. ë‹¤ë¥¸ Delta E 2000 ë³€í˜• ì‚¬ìš©
        </div>

        <div id="testResults"></div>

        <h2>ğŸ¯ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
        <button onclick="runAllTests()">ëª¨ë“  í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
        
        <div id="allTestResults"></div>
    </div>

    <script>
        // Delta E 2000 with adjustable weights
        function calculateDeltaE00_Weighted(L1, a1, b1, L2, a2, b2, kL = 1, kC = 1, kH = 1) {
            // Standard Delta E 2000 calculation
            const C1 = Math.sqrt(a1 * a1 + b1 * b1);
            const C2 = Math.sqrt(a2 * a2 + b2 * b2);
            const Cb = (C1 + C2) / 2;
            
            const G = 0.5 * (1 - Math.sqrt(Math.pow(Cb, 7) / (Math.pow(Cb, 7) + Math.pow(25, 7))));
            const ap1 = a1 * (1 + G);
            const ap2 = a2 * (1 + G);
            
            const Cp1 = Math.sqrt(ap1 * ap1 + b1 * b1);
            const Cp2 = Math.sqrt(ap2 * ap2 + b2 * b2);
            
            let hp1 = Math.atan2(b1, ap1) * 180 / Math.PI;
            if (hp1 < 0) hp1 += 360;
            let hp2 = Math.atan2(b2, ap2) * 180 / Math.PI;
            if (hp2 < 0) hp2 += 360;
            
            const dLp = L2 - L1;
            const dCp = Cp2 - Cp1;
            
            let dhp = hp2 - hp1;
            if (Math.abs(dhp) > 180) {
                if (dhp > 180) dhp -= 360;
                else dhp += 360;
            }
            
            const dHp = 2 * Math.sqrt(Cp1 * Cp2) * Math.sin((dhp * Math.PI / 180) / 2);
            
            const Lbp = (L1 + L2) / 2;
            const Cbp = (Cp1 + Cp2) / 2;
            
            let hbp = (hp1 + hp2) / 2;
            if (Math.abs(hp1 - hp2) > 180) {
                if (hbp < 180) hbp += 180;
                else hbp -= 180;
            }
            
            const T = 1 - 0.17 * Math.cos((hbp - 30) * Math.PI / 180) +
                     0.24 * Math.cos(2 * hbp * Math.PI / 180) +
                     0.32 * Math.cos((3 * hbp + 6) * Math.PI / 180) -
                     0.20 * Math.cos((4 * hbp - 63) * Math.PI / 180);
            
            const SL = 1 + (0.015 * Math.pow(Lbp - 50, 2)) / Math.sqrt(20 + Math.pow(Lbp - 50, 2));
            const SC = 1 + 0.045 * Cbp;
            const SH = 1 + 0.015 * Cbp * T;
            
            const dTheta = 30 * Math.exp(-Math.pow((hbp - 275) / 25, 2));
            const RC = 2 * Math.sqrt(Math.pow(Cbp, 7) / (Math.pow(Cbp, 7) + Math.pow(25, 7)));
            const RT = -RC * Math.sin(2 * dTheta * Math.PI / 180);
            
            const dE00 = Math.sqrt(
                Math.pow(dLp / (kL * SL), 2) +
                Math.pow(dCp / (kC * SC), 2) +
                Math.pow(dHp / (kH * SH), 2) +
                RT * (dCp / (kC * SC)) * (dHp / (kH * SH))
            );
            
            return dE00;
        }

        function testWeightings() {
            const L1 = 43.7, a1 = -31.9, b1 = 2.8;
            const L2 = 43.9, a2 = -27.3, b2 = 1.8;
            
            const tests = [
                { kL: 1, kC: 1, kH: 1, name: "í‘œì¤€ (1:1:1)" },
                { kL: 2, kC: 1, kH: 1, name: "í…ìŠ¤íƒ€ì¼ (2:1:1)" },
                { kL: 1, kC: 2, kH: 1, name: "ìƒ‰ìƒ ê°•ì¡° (1:2:1)" },
                { kL: 1, kC: 1, kH: 2, name: "ìƒ‰ì¡° ê°•ì¡° (1:1:2)" },
                { kL: 0.65, kC: 1, kH: 1, name: "kL=0.65" },
                { kL: 0.75, kC: 1, kH: 1, name: "kL=0.75" },
                { kL: 1.5, kC: 1, kH: 1, name: "kL=1.5" }
            ];
            
            let html = '<h3>ê°€ì¤‘ì¹˜ í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3><table>';
            html += '<tr><th>ì„¤ì •</th><th>Î”E00</th><th>ëª©í‘œì™€ ì°¨ì´</th></tr>';
            
            tests.forEach(test => {
                const deltaE = calculateDeltaE00_Weighted(L1, a1, b1, L2, a2, b2, test.kL, test.kC, test.kH);
                const diff = Math.abs(deltaE - 2.8);
                const match = diff < 0.05 ? 'âœ…' : '';
                html += `<tr>
                    <td>${test.name}</td>
                    <td>${deltaE.toFixed(3)} ${match}</td>
                    <td>${diff.toFixed(3)}</td>
                </tr>`;
            });
            
            html += '</table>';
            document.getElementById('testResults').innerHTML = html;
        }

        function runAllTests() {
            const L1 = 43.7, a1 = -31.9, b1 = 2.8;
            const L2 = 43.9, a2 = -27.3, b2 = 1.8;
            
            let html = '<h3>ì¢…í•© í…ŒìŠ¤íŠ¸ ê²°ê³¼</h3>';
            
            // 1. íŒŒë¼ë¯¸í„° ì¡°í•© í…ŒìŠ¤íŠ¸
            html += '<h4>1. íŒŒë¼ë¯¸í„° ì¡°í•©ìœ¼ë¡œ 2.80 ì°¾ê¸°</h4>';
            html += '<table><tr><th>kL</th><th>kC</th><th>kH</th><th>Î”E00</th><th>ë§¤ì¹­</th></tr>';
            
            for (let kL = 0.5; kL <= 2; kL += 0.1) {
                for (let kC = 0.8; kC <= 1.2; kC += 0.1) {
                    for (let kH = 0.8; kH <= 1.2; kH += 0.1) {
                        const deltaE = calculateDeltaE00_Weighted(L1, a1, b1, L2, a2, b2, kL, kC, kH);
                        if (Math.abs(deltaE - 2.8) < 0.01) {
                            html += `<tr style="background: #c8e6c9;">
                                <td>${kL.toFixed(1)}</td>
                                <td>${kC.toFixed(1)}</td>
                                <td>${kH.toFixed(1)}</td>
                                <td>${deltaE.toFixed(3)}</td>
                                <td>âœ… ë§¤ì¹­!</td>
                            </tr>`;
                        }
                    }
                }
            }
            html += '</table>';
            
            // 2. êµ¬í˜„ ì°¨ì´ ê°€ëŠ¥ì„±
            html += '<h4>2. êµ¬í˜„ ì°¨ì´ ê°€ëŠ¥ì„±</h4>';
            html += '<div class="warning">';
            html += '<p><strong>ê°€ëŠ¥í•œ êµ¬í˜„ ì°¨ì´:</strong></p>';
            html += '<ul>';
            html += '<li>ì¸¡ì •ê¸°ê°€ íŠ¹ì • ì‚°ì—… í‘œì¤€ ì‚¬ìš© (ASTM, ISO ë“±)</li>';
            html += '<li>RT (rotation term) ê³„ì‚° ì°¨ì´</li>';
            html += '<li>ì†Œìˆ˜ì  ì²˜ë¦¬ ë°©ì‹ ì°¨ì´</li>';
            html += '<li>ì¸¡ì • ì¡°ê±´ ë³´ì • ê³„ìˆ˜ ì ìš©</li>';
            html += '</ul>';
            html += '</div>';
            
            document.getElementById('allTestResults').innerHTML = html;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìë™ ì‹¤í–‰
        window.onload = function() {
            testWeightings();
            runAllTests();
        };
    </script>
</body>
</html>