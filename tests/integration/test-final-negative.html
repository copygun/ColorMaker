<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>최종 음수 입력 테스트</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 50px;
            background: #f0f0f0;
        }
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 30px;
        }
        .test-section {
            margin: 30px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        .test-section h3 {
            margin-top: 0;
            color: #555;
        }
        input {
            padding: 10px;
            font-size: 16px;
            border: 2px solid #ddd;
            border-radius: 5px;
            width: 200px;
            margin: 10px 0;
        }
        input:focus {
            outline: none;
            border-color: #4CAF50;
        }
        .output {
            margin-top: 10px;
            padding: 10px;
            background: #e8f5e9;
            border-radius: 5px;
            font-family: monospace;
        }
        .instructions {
            background: #fff3e0;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .instructions ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        .success {
            color: #4CAF50;
            font-weight: bold;
        }
        .fail {
            color: #f44336;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🔬 최종 음수 입력 테스트</h1>
        
        <div class="instructions">
            <h3>테스트 방법:</h3>
            <ul>
                <li>각 입력 필드에 <strong>-50</strong>을 입력해보세요</li>
                <li>먼저 <strong>-</strong> 키를 누르고</li>
                <li>그 다음 <strong>5</strong>, <strong>0</strong>을 순서대로 입력</li>
                <li>입력 필드에 "-50"이 표시되면 성공입니다</li>
            </ul>
        </div>

        <div class="test-section">
            <h3>테스트 1: React와 동일한 방식</h3>
            <input 
                type="text" 
                id="test1" 
                placeholder="-20 입력"
                value="0"
            />
            <div class="output" id="output1">현재 값: 0</div>
        </div>

        <div class="test-section">
            <h3>테스트 2: 단순 입력 (제한 없음)</h3>
            <input 
                type="text" 
                id="test2" 
                placeholder="-20 입력"
            />
            <div class="output" id="output2">현재 값: </div>
        </div>

        <div class="test-section">
            <h3>테스트 3: 지연된 업데이트</h3>
            <input 
                type="text" 
                id="test3" 
                placeholder="-20 입력"
                value="0"
            />
            <div class="output" id="output3">현재 값: 0 (blur 시 업데이트)</div>
        </div>
    </div>

    <script>
        // Test 1: React와 유사한 방식
        const test1 = document.getElementById('test1');
        const output1 = document.getElementById('output1');
        let state1 = { value: 0, inputValue: '0' };

        test1.addEventListener('input', function(e) {
            const newValue = e.target.value;
            console.log('Test1 input:', newValue);
            
            // 입력값 저장
            state1.inputValue = newValue;
            
            // 유효한 숫자일 때만 state 업데이트
            if (newValue !== '-' && newValue !== '.' && newValue !== '-.') {
                const num = parseFloat(newValue);
                if (!isNaN(num)) {
                    state1.value = num;
                    output1.innerHTML = `현재 값: <span class="success">${num}</span>`;
                }
            } else {
                output1.innerHTML = `입력 중: <span>${newValue}</span>`;
            }
        });

        test1.addEventListener('blur', function(e) {
            const inputValue = state1.inputValue;
            if (inputValue === '-' || inputValue === '.' || inputValue === '-.') {
                test1.value = state1.value.toString();
                state1.inputValue = state1.value.toString();
            } else {
                const num = parseFloat(inputValue);
                if (!isNaN(num)) {
                    state1.value = num;
                    test1.value = num.toString();
                    output1.innerHTML = `현재 값: <span class="success">${num}</span>`;
                }
            }
        });

        // Test 2: 단순 입력
        const test2 = document.getElementById('test2');
        const output2 = document.getElementById('output2');

        test2.addEventListener('input', function(e) {
            const value = e.target.value;
            console.log('Test2 input:', value);
            output2.innerHTML = `현재 값: <span class="success">${value}</span>`;
        });

        // Test 3: 지연된 업데이트
        const test3 = document.getElementById('test3');
        const output3 = document.getElementById('output3');
        let state3 = { value: 0, inputValue: '0' };

        test3.addEventListener('input', function(e) {
            const newValue = e.target.value;
            console.log('Test3 input:', newValue);
            state3.inputValue = newValue;
            output3.innerHTML = `입력 중: <span>${newValue}</span> (blur 시 적용)`;
        });

        test3.addEventListener('blur', function(e) {
            const inputValue = state3.inputValue;
            if (inputValue === '' || inputValue === '-' || inputValue === '.') {
                test3.value = state3.value.toString();
                state3.inputValue = state3.value.toString();
            } else {
                const num = parseFloat(inputValue);
                if (!isNaN(num)) {
                    state3.value = num;
                    output3.innerHTML = `현재 값: <span class="success">${num}</span>`;
                } else {
                    test3.value = state3.value.toString();
                    state3.inputValue = state3.value.toString();
                }
            }
        });

        console.log('테스트 준비 완료 - 각 입력 필드에 -50을 입력해보세요');
    </script>
</body>
</html>