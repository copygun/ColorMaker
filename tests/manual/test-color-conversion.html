<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ìƒ‰ìƒ ë³€í™˜ ê²€ì¦</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
        }
        .color-box {
            width: 100px;
            height: 100px;
            border: 2px solid #333;
            margin: 10px 0;
            display: inline-block;
        }
        .result {
            background: #f7f7f7;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background: #f0f0f0;
        }
        .match { background: #d4f4dd; }
        .mismatch { background: #ffd4d4; }
    </style>
</head>
<body>
    <h1>ğŸ¨ PANTONE 317C ìƒ‰ìƒ ë³€í™˜ ê²€ì¦</h1>
    
    <div class="test-section">
        <h2>ì…ë ¥ ê°’ (PANTONE 317C - D50/2Â° ê¸°ì¤€)</h2>
        <ul>
            <li><strong>Lab:</strong> L=84.5, a=-18.0, b=-7.5</li>
            <li><strong>ì˜ˆìƒ HEX:</strong> #B1E4E3 (ì¸ì‡„ í‘œì¤€)</li>
        </ul>
    </div>

    <div class="test-section">
        <h2>ë³€í™˜ í…ŒìŠ¤íŠ¸</h2>
        <div id="test-results"></div>
    </div>

    <script>
        // D50/2Â° ì°¸ì¡° ë°±ìƒ‰ì 
        const D50_WHITE = { X: 96.422, Y: 100.000, Z: 82.521 };
        const D65_WHITE = { X: 95.047, Y: 100.000, Z: 108.883 };
        
        // Bradford ë³€í™˜ í–‰ë ¬ (D50 to D65)
        const D50_TO_D65 = [
            [0.9555766, -0.0230393, 0.0631636],
            [-0.0282895, 1.0099416, 0.0210077],
            [0.0122982, -0.0204830, 1.3299098]
        ];

        // Lab to XYZ (D50 ê¸°ì¤€)
        function labToXYZ_D50(L, a, b) {
            const fy = (L + 16) / 116;
            const fx = a / 500 + fy;
            const fz = fy - b / 200;
            
            const epsilon = 0.008856;
            const kappa = 903.3;
            
            const xr = fx ** 3 > epsilon ? fx ** 3 : (116 * fx - 16) / kappa;
            const yr = L > kappa * epsilon ? fy ** 3 : L / kappa;
            const zr = fz ** 3 > epsilon ? fz ** 3 : (116 * fz - 16) / kappa;
            
            return {
                X: xr * D50_WHITE.X,
                Y: yr * D50_WHITE.Y,
                Z: zr * D50_WHITE.Z
            };
        }

        // XYZ to RGB (sRGB)
        function xyzToRGB(X, Y, Z, fromD50 = true) {
            // D50ì—ì„œ D65ë¡œ ìƒ‰ìˆœì‘ ë³€í™˜
            if (fromD50) {
                const m = D50_TO_D65;
                const X65 = m[0][0] * X + m[0][1] * Y + m[0][2] * Z;
                const Y65 = m[1][0] * X + m[1][1] * Y + m[1][2] * Z;
                const Z65 = m[2][0] * X + m[2][1] * Y + m[2][2] * Z;
                X = X65;
                Y = Y65;
                Z = Z65;
            }
            
            // XYZë¥¼ 0-1 ë²”ìœ„ë¡œ ì •ê·œí™”
            X = X / 100;
            Y = Y / 100;
            Z = Z / 100;
            
            // XYZ to linear RGB
            let r = X * 3.2406 + Y * -1.5372 + Z * -0.4986;
            let g = X * -0.9689 + Y * 1.8758 + Z * 0.0415;
            let b = X * 0.0557 + Y * -0.2040 + Z * 1.0570;
            
            // Gamma correction
            r = r > 0.0031308 ? 1.055 * Math.pow(r, 1/2.4) - 0.055 : 12.92 * r;
            g = g > 0.0031308 ? 1.055 * Math.pow(g, 1/2.4) - 0.055 : 12.92 * g;
            b = b > 0.0031308 ? 1.055 * Math.pow(b, 1/2.4) - 0.055 : 12.92 * b;
            
            return {
                r: Math.max(0, Math.min(255, Math.round(r * 255))),
                g: Math.max(0, Math.min(255, Math.round(g * 255))),
                b: Math.max(0, Math.min(255, Math.round(b * 255)))
            };
        }

        // RGB to HSL
        function rgbToHSL(r, g, b) {
            r /= 255;
            g /= 255;
            b /= 255;
            
            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            const l = (max + min) / 2;
            
            let h = 0;
            let s = 0;
            
            if (max !== min) {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
                
                if (max === r) {
                    h = ((g - b) / d + (g < b ? 6 : 0));
                } else if (max === g) {
                    h = ((b - r) / d + 2);
                } else {
                    h = ((r - g) / d + 4);
                }
            }
            
            h = Math.round(h * 60);
            if (h < 0) h += 360;
            s = Math.round(s * 100);
            const lPercent = Math.round(l * 100);
            
            return { h, s, l: lPercent };
        }

        // RGB to Hex
        function rgbToHex(r, g, b) {
            const toHex = n => n.toString(16).padStart(2, '0');
            return `#${toHex(r)}${toHex(g)}${toHex(b)}`.toUpperCase();
        }

        // í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        function runTest() {
            const L = 84.5, a = -18.0, b = -7.5;
            
            // 1. Lab to XYZ (D50)
            const xyz = labToXYZ_D50(L, a, b);
            
            // 2. XYZ to RGB (with D50 to D65 adaptation)
            const rgb = xyzToRGB(xyz.X, xyz.Y, xyz.Z, true);
            
            // 3. RGB to HSL
            const hsl = rgbToHSL(rgb.r, rgb.g, rgb.b);
            
            // 4. RGB to Hex
            const hex = rgbToHex(rgb.r, rgb.g, rgb.b);
            
            // ê²°ê³¼ í‘œì‹œ
            const results = `
                <h3>ë³€í™˜ ê²°ê³¼</h3>
                <table>
                    <tr>
                        <th>ìƒ‰ìƒ ê³µê°„</th>
                        <th>ê³„ì‚°ê°’</th>
                        <th>ì˜ˆìƒê°’/ì°¸ê³ ê°’</th>
                        <th>ë¹„êµ</th>
                    </tr>
                    <tr>
                        <td><strong>Lab (ì…ë ¥)</strong></td>
                        <td>L=${L}, a=${a}, b=${b}</td>
                        <td>D50/2Â° ê¸°ì¤€</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>XYZ (D50)</strong></td>
                        <td>X=${xyz.X.toFixed(2)}, Y=${xyz.Y.toFixed(2)}, Z=${xyz.Z.toFixed(2)}</td>
                        <td>ì¤‘ê°„ ê³„ì‚°</td>
                        <td>-</td>
                    </tr>
                    <tr>
                        <td><strong>RGB</strong></td>
                        <td>R=${rgb.r}, G=${rgb.g}, B=${rgb.b}</td>
                        <td>sRGB (D65 adapted)</td>
                        <td>-</td>
                    </tr>
                    <tr class="${hex === '#B1E4E3' ? 'match' : 'mismatch'}">
                        <td><strong>HEX</strong></td>
                        <td>${hex}</td>
                        <td>#B1E4E3 (PANTONE ê³µì‹)</td>
                        <td>${hex === '#B1E4E3' ? 'âœ… ì¼ì¹˜' : 'âŒ ë¶ˆì¼ì¹˜'}</td>
                    </tr>
                    <tr class="${Math.abs(hsl.h - 178) < 5 ? 'match' : 'mismatch'}">
                        <td><strong>HSL</strong></td>
                        <td>H=${hsl.h}Â°, S=${hsl.s}%, L=${hsl.l}%</td>
                        <td>Hâ‰ˆ178-181Â°, Sâ‰ˆ51%, Lâ‰ˆ78%</td>
                        <td>${Math.abs(hsl.h - 180) < 5 ? 'âœ… ì •ìƒ ë²”ìœ„' : 'âš ï¸ í™•ì¸ í•„ìš”'}</td>
                    </tr>
                </table>
                
                <h3>ìƒ‰ìƒ ë¯¸ë¦¬ë³´ê¸°</h3>
                <div style="display: flex; gap: 20px; align-items: center;">
                    <div>
                        <div class="color-box" style="background-color: ${hex};"></div>
                        <p>ê³„ì‚°ëœ ìƒ‰ìƒ<br/>${hex}</p>
                    </div>
                    <div>
                        <div class="color-box" style="background-color: #B1E4E3;"></div>
                        <p>PANTONE 317C ê³µì‹<br/>#B1E4E3</p>
                    </div>
                    <div>
                        <div class="color-box" style="background-color: #ACE3E4;"></div>
                        <p>êµ¬ê¸€ ê²€ìƒ‰ ê²°ê³¼<br/>#ACE3E4</p>
                    </div>
                </div>
                
                <h3>ë¶„ì„</h3>
                <div class="result">
                    <p><strong>HSL ë³€í™˜ ê²€ì¦:</strong></p>
                    <ul>
                        <li>ê³„ì‚°ëœ HSL: H=${hsl.h}Â°, S=${hsl.s}%, L=${hsl.l}%</li>
                        <li>êµ¬ê¸€ HSL (181Â°, 51%, 78%)ê³¼ ${Math.abs(hsl.h - 181) < 3 ? 'ê±°ì˜ ì¼ì¹˜' : 'ì°¨ì´ ìˆìŒ'}</li>
                        <li>ì°¨ì´ ì›ì¸: ${hsl.h < 180 ? 'Cyan ì˜ì—­ì—ì„œ ë…¹ìƒ‰ ìª½' : 'Cyan ì˜ì—­ì—ì„œ ì²­ìƒ‰ ìª½'}ìœ¼ë¡œ ê³„ì‚°ë¨</li>
                    </ul>
                    
                    <p><strong>HEX ì°¨ì´ ë¶„ì„:</strong></p>
                    <ul>
                        <li>ê³„ì‚°ê°’: ${hex}</li>
                        <li>êµ¬ê¸€ê°’: #ACE3E4</li>
                        <li>ì°¨ì´: RGBì—ì„œ ì•½ê°„ì˜ ì°¨ì´ (íŠ¹íˆ R ì±„ë„)</li>
                        <li>ì›ì¸: D50â†’D65 ìƒ‰ìˆœì‘ ë³€í™˜ ë˜ëŠ” ê°ë§ˆ ë³´ì • ì°¨ì´</li>
                    </ul>
                </div>
            `;
            
            document.getElementById('test-results').innerHTML = results;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        window.onload = runTest;
    </script>
</body>
</html>